{
  "$id": "http://www.parcore.org/schema/preservation_action.json/#",
  "$schema": "http://json-schema.org/draft-06/schema#",
  "definitions": {
    "inputItem": {
      "description": "An input to a preservation action",
      "title": "Preservation Action Input",
      "type": "object",
      "properties": {
        "inputItemName": {
          "type": "string"
        },
        "inputItemType": {
          "enum": [
            "File",
            "string",
            "boolean",
            "integer",
            "stdin"
          ]
        },
        "inputItemDescription": {
          "type": "string"
        },
        "inputItemBinding": {
          "type": "object",
          "properties": {
            "prefix": {
              "type": "string"
            },
            "position": {
              "type": "integer"
            }
          }
        },
        "secondaryFiles": {
          "type": "array",
          "description": "files that need to be present when a tool is run, but are not listed on the command line",
          "minItems": 1,
          "items": {
            "type": "object",
            "properties": {
              "secondaryFileDescription": {
                "type": "string"
              },
              "secondaryFileName": {
                "type": "string"
              }
            }
          }
        }
      },
      "required": [
        "inputItemName",
        "inputItemType",
        "inputItemBinding"
      ],
      "additionalProperties": false
    },
    "outputItem": {
      "description": "An output from a preservation action",
      "title": "Preservation Action Output",
      "type": "object",
      "properties": {
        "outputItemName": {
          "type": "string"
        },
        "outputItemDescription": {
          "type": "string"
        },
        "outputItemType": {
          "enum": [
            "File",
            "stdout",
            "stderr"
          ]
        },
        "outputItemBinding": {
          "type": "object",
          "properties": {
            "glob": {
              "type": "string"
            }
          }
        },
        "outputItemMapping": {
          "type": "object",
          "properties": {
            "mappingExpressionType": {
              "enum": [
                "shellScript",
                "javaScript",
                "XPath"
              ]
            },
            "mappingExpression": {
              "type": "string"
            },
            "mapping": {
              "parPropertyId": {
                "type": "string"
              }
            }
          }
        }
      },
      "additionalProperties": false
    }
  },
  "title": "Preservation Action",
  "type": "object",
  "properties": {
    "preservationActionID": {
      "type": "string"
    },
    "preservationActionDescription": {
      "type": "string"
    },
    "preservationActionExample": {
      "type": "string"
    },
    "preservationActionType": {
      "$ref": "http://www.parcore.org/schema/preservation_action_type.json/#"
    },
    "inputs": {
      "type": "array",
      "items": {
        "$ref": "http://www.parcore.org/schema/preservation_action.json/#/definitions/inputItem"
      },
      "minItems": 1,
      "additionalItems": false
    },
    "outputs": {
      "type": "array",
      "items": {
        "$ref": "http://www.parcore.org/schema/preservation_action.json/#/definitions/outputItem"
      },
      "minItems": 1,
      "additionalItems": false
    },
    "constraints": {
      "type": "array",
      "items": {
        "$ref": "http://www.parcore.org/schema/par_property.json/#"
      },
      "minItems": 1,
      "additionalItems": false
    },
    "tool": {
      "$ref": "http://www.parcore.org/schema/tool.json/#",
      "minItems": 1,
      "additionalItems": false
    }
  },
  "required": [
    "preservationActionID",
    "preservationActionDescription",
    "preservationActionType",
    "inputs",
    "outputs",
    "tool"
  ]
}
